{"ast":null,"code":"import _objectSpread from\"C:/Users/jengs/Desktop/studdyBuddy/studybuddy/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback}from'react';import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GOOGLE_CLIENT_ID='690038744070-3o95qmee1h9mk3aas12st4q36k824m8b.apps.googleusercontent.com';const SCOPES='https://www.googleapis.com/auth/calendar.events';const GOOGLE_MAPS_API_KEY='AIzaSyBeS7SWjIBiudPOTdrhluEJwhtriQZWOzg';const ALL_COURSES=[{\"code\":\"ACCT 351\",\"name\":\"Intermediate Financial Accounting 1\"},{\"code\":\"ACCT 352\",\"name\":\"Intermediate Financial Accounting 2\"},{\"code\":\"ACCT 361\",\"name\":\"Managerial Accounting\"},{\"code\":\"COMP 202\",\"name\":\"Foundations of Programming\"},{\"code\":\"COMP 206\",\"name\":\"Introduction to Software Systems\"},{\"code\":\"COMP 250\",\"name\":\"Introduction to Computer Science\"},{\"code\":\"COMP 251\",\"name\":\"Algorithms and Data Structures\"},{\"code\":\"COMP 273\",\"name\":\"Introduction to Computer Systems\"},{\"code\":\"ECON 208\",\"name\":\"Microeconomic Analysis and Applications\"},{\"code\":\"ECON 209\",\"name\":\"Macroeconomic Analysis and Applications\"},{\"code\":\"MATH 140\",\"name\":\"Calculus 1\"},{\"code\":\"MATH 141\",\"name\":\"Calculus 2\"},{\"code\":\"PSYC 100\",\"name\":\"Introduction to Psychology 1\"},{\"code\":\"BIOL 111\",\"name\":\"Principles: Organismal Biology\"},{\"code\":\"CHEM 110\",\"name\":\"General Chemistry 1\"}];// McGill Buildings\nconst ALL_BUILDINGS=[{id:'mclennan',name:'McLennan-Redpath Library',booking:false},{id:'schulich',name:'Schulich Library of Science',booking:false},{id:'humanities',name:'Humanities & Social Sciences Library',booking:false},{id:'trottier',name:'Trottier Building',booking:true,url:'https://calendar.google.com/calendar/u/0/appointments/AcZssZ21fWlz5fAbV51y6M5Bkc3t5denCAnFJ6wZQls='}];// Fallback nearby caf√©s around McGill ‚Äî sorted closest to farthest\nconst FALLBACK_PLACES=[{id:'cafe7',name:'Second Cup ‚Äì McGill',address:'3475 Rue McTavish, Montr√©al',rating:4.0,totalRatings:310,lat:45.5052,lng:-73.5770,distance:'0.2',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 6:30 AM ‚Äì 9:00 PM','Tuesday: 6:30 AM ‚Äì 9:00 PM','Wednesday: 6:30 AM ‚Äì 9:00 PM','Thursday: 6:30 AM ‚Äì 9:00 PM','Friday: 6:30 AM ‚Äì 9:00 PM','Saturday: 7:30 AM ‚Äì 8:00 PM','Sunday: 7:30 AM ‚Äì 8:00 PM']},{id:'cafe6',name:'Arts Caf√©',address:'201 Ave du Pr√©sident-Kennedy, Montr√©al',rating:4.2,totalRatings:450,lat:45.5077,lng:-73.5712,distance:'0.5',priceLevel:1,openNow:true,busy:'Busy',hours:['Monday: 7:00 AM ‚Äì 10:00 PM','Tuesday: 7:00 AM ‚Äì 10:00 PM','Wednesday: 7:00 AM ‚Äì 10:00 PM','Thursday: 7:00 AM ‚Äì 10:00 PM','Friday: 7:00 AM ‚Äì 10:00 PM','Saturday: 8:00 AM ‚Äì 10:00 PM','Sunday: 8:00 AM ‚Äì 10:00 PM']},{id:'cafe5',name:'Pikolo Espresso Bar',address:'3418a Ave du Parc, Montr√©al',rating:4.5,totalRatings:720,lat:45.5112,lng:-73.5748,distance:'0.8',priceLevel:1,openNow:true,busy:'Quiet',hours:['Monday: 7:00 AM ‚Äì 7:00 PM','Tuesday: 7:00 AM ‚Äì 7:00 PM','Wednesday: 7:00 AM ‚Äì 7:00 PM','Thursday: 7:00 AM ‚Äì 7:00 PM','Friday: 7:00 AM ‚Äì 7:00 PM','Saturday: 8:00 AM ‚Äì 7:00 PM','Sunday: 8:00 AM ‚Äì 7:00 PM']},{id:'cafe4',name:'Caf√© Myriade',address:'1432 Rue Mackay, Montr√©al',rating:4.5,totalRatings:1560,lat:45.4973,lng:-73.5778,distance:'0.9',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 7:30 AM ‚Äì 6:00 PM','Tuesday: 7:30 AM ‚Äì 6:00 PM','Wednesday: 7:30 AM ‚Äì 6:00 PM','Thursday: 7:30 AM ‚Äì 6:00 PM','Friday: 7:30 AM ‚Äì 6:00 PM','Saturday: 8:30 AM ‚Äì 6:00 PM','Sunday: 8:30 AM ‚Äì 6:00 PM']},{id:'cafe8',name:'Caf√© Nocturne',address:'3584 Boul Saint-Laurent, Montr√©al',rating:4.3,totalRatings:560,lat:45.5150,lng:-73.5680,distance:'1.2',priceLevel:2,openNow:true,busy:'Quiet',hours:['Monday: 8:00 AM ‚Äì 11:00 PM','Tuesday: 8:00 AM ‚Äì 11:00 PM','Wednesday: 8:00 AM ‚Äì 11:00 PM','Thursday: 8:00 AM ‚Äì 11:00 PM','Friday: 8:00 AM ‚Äì 11:00 PM','Saturday: 9:00 AM ‚Äì 12:00 AM','Sunday: 9:00 AM ‚Äì 10:00 PM']},{id:'cafe2',name:'Crew Collective & Caf√©',address:'360 Rue Saint-Jacques, Montr√©al',rating:4.4,totalRatings:3120,lat:45.5025,lng:-73.5604,distance:'1.6',priceLevel:2,openNow:true,busy:'Busy',hours:['Monday: 8:00 AM ‚Äì 5:00 PM','Tuesday: 8:00 AM ‚Äì 5:00 PM','Wednesday: 8:00 AM ‚Äì 5:00 PM','Thursday: 8:00 AM ‚Äì 5:00 PM','Friday: 8:00 AM ‚Äì 5:00 PM','Saturday: 9:00 AM ‚Äì 5:00 PM','Sunday: 9:00 AM ‚Äì 5:00 PM']},{id:'cafe1',name:'Caf√© Olimpico',address:'124 Rue Saint-Viateur O, Montr√©al',rating:4.5,totalRatings:2840,lat:45.5225,lng:-73.5985,distance:'2.4',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 6:00 AM ‚Äì 12:00 AM','Tuesday: 6:00 AM ‚Äì 12:00 AM','Wednesday: 6:00 AM ‚Äì 12:00 AM','Thursday: 6:00 AM ‚Äì 12:00 AM','Friday: 6:00 AM ‚Äì 12:00 AM','Saturday: 6:00 AM ‚Äì 12:00 AM','Sunday: 6:00 AM ‚Äì 12:00 AM']},{id:'cafe3',name:'Dispatch Coffee',address:'1000 Rue Bellechasse, Montr√©al',rating:4.6,totalRatings:890,lat:45.5341,lng:-73.5956,distance:'3.5',priceLevel:2,openNow:true,busy:'Quiet',hours:['Monday: 8:00 AM ‚Äì 5:00 PM','Tuesday: 8:00 AM ‚Äì 5:00 PM','Wednesday: 8:00 AM ‚Äì 5:00 PM','Thursday: 8:00 AM ‚Äì 5:00 PM','Friday: 8:00 AM ‚Äì 5:00 PM','Saturday: 9:00 AM ‚Äì 5:00 PM','Sunday: 9:00 AM ‚Äì 5:00 PM']}];export default function StudyBuddy(){var _selectedPlace$photos,_selectedPlace$review,_data$type;const CURRENT_USER_ID=\"user_001\";// const [sessionType, setSessionType] = useState(\"online\");\n// const [visibility, setVisibility] = useState(\"public\");\n// const [selectedCourse, setSelectedCourse] = useState(\"\");\n// const [note, setNote] = useState(\"\");\n// const [whenValue, setWhenValue] = useState(\"now\");\n// const [maxSize, setMaxSize] = useState(5);\n// const [gender, setGender] = useState(\"any\");\nconst[modal,setModal]=useState(false);const[step,setStep]=useState(1);const[sessions,setSessions]=useState([{id:1,course:'COMP 202',name:'Programming Practice',location:'Caf√© Olimpico',time:'2:00 PM',members:2,maxMembers:5,organizer:'Sarah Chen',meetLink:null}]);const[data,setData]=useState({type:'',visibility:'',courseMode:'',courses:[],locType:'',location:null,timeMode:'',date:'',start:'',end:'',maxMembers:5,genderPref:'any'});const[search,setSearch]=useState('');const[dropdown,setDropdown]=useState(false);const[userLocation,setUserLocation]=useState(null);const[nearbyPlaces,setNearbyPlaces]=useState([]);const[mapLoaded,setMapLoaded]=useState(false);const[showMap,setShowMap]=useState(false);const[selectedPlace,setSelectedPlace]=useState(null);const[showHoursPanel,setShowHoursPanel]=useState(false);const ref=useRef(null);const mapRef=useRef(null);const googleMapRef=useRef(null);const markersRef=useRef([]);const selectedMarkerRef=useRef(null);const[googleUser,setGoogleUser]=useState(null);const[accessToken,setAccessToken]=useState(null);const tokenClientRef=useRef(null);const placesLoadedRef=useRef(false);const[locationGranted,setLocationGranted]=useState(false);const[showLocationPopup,setShowLocationPopup]=useState(false);useEffect(()=>{const fetchSessions=async()=>{try{var _res$data;const res=await axios.post(\"http://127.0.0.1:8000/sessions/match\",{user_id:CURRENT_USER_ID});if((_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.error){console.error(\"Error fetching matched sessions:\",res.data.error);setSessions([]);return;}const rawSessions=Array.isArray(res.data)?res.data:[];const mappedSessions=rawSessions.map(s=>{var _s$location;return{id:s._id||Date.now(),course:s.course||\"Study\",name:s.course||\"Study Session\",// fallback to course if no name\nlocation:s.type===\"online\"?\"Online\":((_s$location=s.location)===null||_s$location===void 0?void 0:_s$location.name)||s.location||\"TBD\",time:s.when===\"now\"?\"LIVE NOW\":s.when||\"TBD\",members:s.members||1,maxMembers:s.max_size||5,organizer:s.created_by||\"Unknown\",meetLink:s.meetLink||null,genderPref:s.gender||\"any\",isLive:s.when===\"now\"};});setSessions(mappedSessions);}catch(err){console.error(\"Error fetching sessions:\",err);}};fetchSessions();},[]);// Load Google Identity Services\nuseEffect(()=>{const s=document.createElement('script');s.src='https://accounts.google.com/gsi/client';s.async=true;s.defer=true;s.onload=()=>{var _window$google,_window$google$accoun,_window$google$accoun2;tokenClientRef.current=(_window$google=window.google)===null||_window$google===void 0?void 0:(_window$google$accoun=_window$google.accounts)===null||_window$google$accoun===void 0?void 0:(_window$google$accoun2=_window$google$accoun.oauth2)===null||_window$google$accoun2===void 0?void 0:_window$google$accoun2.initTokenClient({client_id:GOOGLE_CLIENT_ID,scope:SCOPES,callback:r=>{if(r.access_token){setAccessToken(r.access_token);setGoogleUser(true);}}});};document.head.appendChild(s);},[]);// Load Google Maps\nuseEffect(()=>{var _window$google2;if(!((_window$google2=window.google)!==null&&_window$google2!==void 0&&_window$google2.maps)){const s=document.createElement('script');s.src=\"https://maps.googleapis.com/maps/api/js?key=\".concat(GOOGLE_MAPS_API_KEY,\"&libraries=places\");s.async=true;s.onload=()=>setMapLoaded(true);s.onerror=()=>setMapLoaded(false);document.head.appendChild(s);}else{setMapLoaded(true);}},[]);const signInWithGoogle=()=>{if(tokenClientRef.current)tokenClientRef.current.requestAccessToken();};const createGoogleMeetLink=async()=>{if(!accessToken)return null;const ev={summary:'StudyBuddy Session',description:'Study session created via StudyBuddy',start:{dateTime:new Date().toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},end:{dateTime:new Date(Date.now()+7200000).toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},conferenceData:{createRequest:{requestId:Math.random().toString(36).substring(2,12),conferenceSolutionKey:{type:'hangoutsMeet'}}}};try{var _d$conferenceData,_d$conferenceData$ent;const res=await fetch('https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1',{method:'POST',headers:{Authorization:\"Bearer \".concat(accessToken),'Content-Type':'application/json'},body:JSON.stringify(ev)});const d=await res.json();const ep=(_d$conferenceData=d.conferenceData)===null||_d$conferenceData===void 0?void 0:(_d$conferenceData$ent=_d$conferenceData.entryPoints)===null||_d$conferenceData$ent===void 0?void 0:_d$conferenceData$ent.find(e=>e.entryPointType==='video');return ep?ep.uri:null;}catch(_unused){return null;}};// Geolocation ‚Äî only set location if user grants permission\nconst requestLocation=useCallback(()=>{return new Promise(resolve=>{if(!navigator.geolocation){resolve(false);return;}navigator.geolocation.getCurrentPosition(p=>{setUserLocation({lat:p.coords.latitude,lng:p.coords.longitude});setLocationGranted(true);resolve(true);},()=>{setLocationGranted(false);resolve(false);});});},[]);// Try requesting on mount silently\nuseEffect(()=>{requestLocation();},[requestLocation]);const calculateDistance=useCallback((lat1,lng1,lat2,lng2)=>{const R=6371,dLat=(lat2-lat1)*Math.PI/180,dLng=(lng2-lng1)*Math.PI/180;const a=Math.sin(dLat/2)**2+Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLng/2)**2;return(R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))).toFixed(1);},[]);const placeSelectionPin=useCallback(place=>{var _window$google3;if(!googleMapRef.current||!((_window$google3=window.google)!==null&&_window$google3!==void 0&&_window$google3.maps))return;if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);}const m=new window.google.maps.Marker({position:{lat:place.lat,lng:place.lng},map:googleMapRef.current,title:place.name,animation:window.google.maps.Animation.BOUNCE,icon:{url:\"data:image/svg+xml,\".concat(encodeURIComponent('<svg width=\"44\" height=\"54\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M22 0C12.3 0 4.4 7.9 4.4 17.6c0 9.7 17.6 36.4 17.6 36.4s17.6-26.7 17.6-36.4C39.6 7.9 31.7 0 22 0z\" fill=\"#DC2626\"/><circle cx=\"22\" cy=\"17.6\" r=\"8.8\" fill=\"white\"/><text x=\"22\" y=\"22\" text-anchor=\"middle\" font-size=\"14\" fill=\"#DC2626\">‚òÖ</text></svg>')),scaledSize:new window.google.maps.Size(44,54),anchor:new window.google.maps.Point(22,54)}});selectedMarkerRef.current=m;setTimeout(()=>m===null||m===void 0?void 0:m.setAnimation(null),1400);googleMapRef.current.panTo({lat:place.lat,lng:place.lng});googleMapRef.current.setZoom(16);},[]);const loadFallbackPlaces=useCallback(()=>{const h=new Date().getHours();const places=FALLBACK_PLACES.map(p=>{let busy='Moderate';if(h>=8&&h<=11)busy=['Busy','Moderate','Quiet'][Math.floor(Math.random()*3)];else if(h>=12&&h<=14)busy='Busy';else if(h>=15&&h<=17)busy=['Busy','Moderate'][Math.floor(Math.random()*2)];else busy='Quiet';return _objectSpread(_objectSpread({},p),{},{busy});});setNearbyPlaces(places);placesLoadedRef.current=true;},[]);const fetchNearbyPlaces=useCallback(map=>{var _window$google4,_window$google4$maps;if(!((_window$google4=window.google)!==null&&_window$google4!==void 0&&(_window$google4$maps=_window$google4.maps)!==null&&_window$google4$maps!==void 0&&_window$google4$maps.places)||!userLocation){loadFallbackPlaces();return;}const svc=new window.google.maps.places.PlacesService(map);const req={location:new window.google.maps.LatLng(userLocation.lat,userLocation.lng),radius:2000,type:['cafe'],keyword:'coffee study wifi'};const t=setTimeout(()=>{if(!placesLoadedRef.current)loadFallbackPlaces();},5000);svc.nearbySearch(req,(results,status)=>{clearTimeout(t);if(status===window.google.maps.places.PlacesServiceStatus.OK&&(results===null||results===void 0?void 0:results.length)>0){markersRef.current.forEach(m=>m.setMap(null));markersRef.current=[];const places=results.slice(0,15).map(place=>{var _place$opening_hours;const dist=calculateDistance(userLocation.lat,userLocation.lng,place.geometry.location.lat(),place.geometry.location.lng());const h=new Date().getHours();let busy='Moderate';if(h>=8&&h<=11)busy=['Busy','Moderate','Quiet'][Math.floor(Math.random()*3)];else if(h>=12&&h<=14)busy='Busy';else if(h>=15&&h<=17)busy=['Busy','Moderate'][Math.floor(Math.random()*2)];else busy='Quiet';const pd={id:place.place_id,name:place.name,address:place.vicinity,rating:place.rating||4.0,totalRatings:place.user_ratings_total||0,busy,lat:place.geometry.location.lat(),lng:place.geometry.location.lng(),placeId:place.place_id,distance:dist,priceLevel:place.price_level||2,openNow:(_place$opening_hours=place.opening_hours)===null||_place$opening_hours===void 0?void 0:_place$opening_hours.open_now,photos:place.photos};const mk=new window.google.maps.Marker({position:{lat:pd.lat,lng:pd.lng},map,title:pd.name,animation:window.google.maps.Animation.DROP,icon:{url:\"data:image/svg+xml,\".concat(encodeURIComponent('<svg width=\"40\" height=\"50\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20 0C11.2 0 4 7.2 4 16c0 8.8 16 34 16 34s16-25.2 16-34c0-8.8-7.2-16-16-16z\" fill=\"#6366F1\"/><circle cx=\"20\" cy=\"16\" r=\"8\" fill=\"white\"/><text x=\"20\" y=\"21\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366F1\" font-weight=\"bold\">‚òï</text></svg>')),scaledSize:new window.google.maps.Size(40,50),anchor:new window.google.maps.Point(20,50)}});mk.addListener('click',()=>{setSelectedPlace(pd);setShowHoursPanel(false);placeSelectionPin(pd);svc.getDetails({placeId:pd.placeId,fields:['opening_hours','website','formatted_phone_number','reviews']},(det,ds)=>{if(ds===window.google.maps.places.PlacesServiceStatus.OK){setSelectedPlace(prev=>{var _det$opening_hours,_det$reviews;return _objectSpread(_objectSpread({},prev),{},{hours:(_det$opening_hours=det.opening_hours)===null||_det$opening_hours===void 0?void 0:_det$opening_hours.weekday_text,website:det.website,phone:det.formatted_phone_number,reviews:(_det$reviews=det.reviews)===null||_det$reviews===void 0?void 0:_det$reviews.slice(0,3)});});}});});markersRef.current.push(mk);return pd;});setNearbyPlaces(places.sort((a,b)=>parseFloat(a.distance)-parseFloat(b.distance)));placesLoadedRef.current=true;}else{loadFallbackPlaces();}});},[userLocation,loadFallbackPlaces,placeSelectionPin,calculateDistance]);// Map init\nuseEffect(()=>{if(showMap&&userLocation){var _window$google5;// Load fallback places immediately so list is never empty\nif(!placesLoadedRef.current)loadFallbackPlaces();if(mapLoaded&&(_window$google5=window.google)!==null&&_window$google5!==void 0&&_window$google5.maps&&mapRef.current){const map=new window.google.maps.Map(mapRef.current,{center:userLocation,zoom:14,styles:[{featureType:\"poi\",elementType:\"labels\",stylers:[{visibility:\"off\"}]}]});googleMapRef.current=map;new window.google.maps.Marker({position:userLocation,map,title:\"You\",icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:10,fillColor:\"#4F46E5\",fillOpacity:1,strokeColor:\"#fff\",strokeWeight:2}});fetchNearbyPlaces(map);}}},[showMap,mapLoaded,userLocation,fetchNearbyPlaces,loadFallbackPlaces]);useEffect(()=>{const h=e=>{if(ref.current&&!ref.current.contains(e.target))setDropdown(false);};document.addEventListener('mousedown',h);return()=>document.removeEventListener('mousedown',h);},[]);const filtered=ALL_COURSES.filter(c=>c.code.toLowerCase().includes(search.toLowerCase())||c.name.toLowerCase().includes(search.toLowerCase()));const toggleCourse=course=>{if(data.courseMode==='single'){setData(_objectSpread(_objectSpread({},data),{},{courses:[course]}));setDropdown(false);}else{const ex=data.courses.find(c=>c.code===course.code);setData(_objectSpread(_objectSpread({},data),{},{courses:ex?data.courses.filter(c=>c.code!==course.code):[...data.courses,course]}));}};// canNext: online sessions always pass step 4 (Google sign-in optional)\nconst canNext=()=>{if(step===1)return data.type;if(step===2)return data.visibility;if(step===3)return data.courseMode==='flex'||data.courses.length>0;if(step===4)return data.type==='online'||data.location;if(step===5){if(!data.timeMode)return false;if(data.timeMode==='scheduled')return data.date&&data.start&&data.end;return true;}return true;};const handleCreateSession=async()=>{const courseName=data.courseMode==='flex'?'Flexible':data.courses.length>0?data.courses.map(c=>c.code).join(', '):'Study';const sessionToSave={type:data.type,visibility:data.visibility,course:courseName,note:data.note||'',when:data.timeMode==='now'?'now':data.timeMode==='scheduled'?\"\".concat(data.date,\" \").concat(data.start,\" - \").concat(data.end):'flexible',max_size:data.maxMembers,gender:data.genderPref,created_by:\"Maria\"};try{await axios.post(\"http://127.0.0.1:8000/sessions\",sessionToSave);alert(\"Session created successfully!\");}catch(error){console.error(\"Error creating session:\",error);}};const createSession=async()=>{var _data$courses$,_data$location;let meetLink=null;if(data.type==='online'&&accessToken)meetLink=await createGoogleMeetLink();const ns={id:Date.now(),course:data.courseMode==='flex'?'Flexible':((_data$courses$=data.courses[0])===null||_data$courses$===void 0?void 0:_data$courses$.code)||'Study',name:data.courseMode==='flex'?'General Study Session':data.courses.map(c=>c.code).join(', '),location:data.type==='online'?'Online':(_data$location=data.location)===null||_data$location===void 0?void 0:_data$location.name,time:data.timeMode==='now'?'LIVE NOW':data.timeMode==='scheduled'?\"\".concat(data.date,\" \").concat(data.start):'Flexible',members:1,maxMembers:data.maxMembers,organizer:'You',meetLink,genderPref:data.genderPref,isLive:data.timeMode==='now'};setSessions([ns,...sessions]);if(meetLink)window.open(meetLink,'_blank');reset();};const reset=()=>{setModal(false);setStep(1);setData({type:'',visibility:'',courseMode:'',courses:[],locType:'',location:null,timeMode:'',date:'',start:'',end:'',maxMembers:5,genderPref:'any'});setSearch('');setShowMap(false);setSelectedPlace(null);setShowHoursPanel(false);placesLoadedRef.current=false;if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);selectedMarkerRef.current=null;}};const joinSession=s=>{if(s.meetLink)window.open(s.meetLink,'_blank');else alert(\"Joining \".concat(s.name,\" at \").concat(s.location,\"!\"));};const openNearbySpots=async()=>{setData(d=>_objectSpread(_objectSpread({},d),{},{locType:'spot'}));if(locationGranted&&userLocation){setShowMap(true);}else{const granted=await requestLocation();if(granted){setShowMap(true);}else{setShowLocationPopup(true);}}};const selectPlaceFromMap=place=>{setData(_objectSpread(_objectSpread({},data),{},{location:place}));setShowMap(false);setSelectedPlace(null);setShowHoursPanel(false);if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);selectedMarkerRef.current=null;}};const BusyBadge=_ref=>{let{busy}=_ref;return/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium \".concat(busy==='Quiet'?'bg-green-100 text-green-700':busy==='Moderate'?'bg-yellow-100 text-yellow-700':'bg-orange-100 text-orange-700'),children:busy});};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-sm p-4 border-b flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-indigo-600\",children:\"StudyBuddy\"}),googleUser?/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-green-600 font-medium\",children:\"\\u2713 Google Connected\"}):/*#__PURE__*/_jsx(\"button\",{onClick:signInWithGoogle,className:\"text-sm px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700\",children:\"Sign in with Google\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Active Sessions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-2 gap-4\",children:sessions.map(s=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl shadow-md border-2 border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-indigo-600\",children:s.course}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg mt-1\",children:s.name})]}),s.isLive&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full\",children:\"LIVE\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\uD83D\\uDCCD \",s.location]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\uD83D\\uDD50 \",s.time]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\uD83D\\uDC65 \",s.members,\"/\",s.maxMembers,\" members\"]}),s.genderPref!=='any'&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\u26A7 \",s.genderPref,\" preferred\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[\"by \",s.organizer]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>joinSession(s),className:\"px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700\",children:s.meetLink?'Join Meet':'Join'})]})]},s.id))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModal(true),className:\"fixed bottom-8 right-8 w-16 h-16 bg-indigo-600 text-white rounded-full shadow-2xl hover:scale-110 transition-transform flex items-center justify-center text-3xl z-50\",children:\"+\"}),modal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl w-full max-w-6xl max-h-[95vh] flex flex-col my-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b flex justify-between items-center shrink-0\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:showMap?'Choose Study Spot':['Session Type','Who Can Join?','Course Selection','Study Location','When to Study?','Group Details'][step-1]}),!showMap&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Step \",step,\" of 6\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:reset,className:\"text-gray-400 hover:text-gray-600 text-2xl\",children:\"\\xD7\"})]}),!showMap&&/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-3 bg-gray-50 shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-600 h-2 rounded-full transition-all\",style:{width:\"\".concat(step/6*100,\"%\")}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto\",children:[!showMap&&step===1&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"How would you like to study?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:['online','in-person'].map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{type:t})),className:\"p-6 rounded-xl border-2 transition-all \".concat(data.type===t?'border-indigo-600 bg-indigo-50 scale-105':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-3\",children:t==='online'?'üíª':'üìç'}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold capitalize\",children:t.replace('-',' ')}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 mt-1\",children:t==='online'?'Google Meet':'Meet at location'})]},t))})]}),!showMap&&step===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Who can see and join?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:['public','private'].map(v=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{visibility:v})),className:\"p-6 rounded-xl border-2 transition-all \".concat(data.visibility===v?'border-indigo-600 bg-indigo-50 scale-105':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-3\",children:v==='public'?'üåç':'üîí'}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold capitalize\",children:v}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 mt-1\",children:v==='public'?'Everyone':'Friends only'})]},v))})]}),!showMap&&step===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"What are you studying?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 gap-3\",children:[{mode:'single',label:'One Course',icon:'üìñ'},{mode:'multi',label:'Multiple',icon:'üìö'},{mode:'flex',label:'Flexible',icon:'‚ú®'}].map(_ref2=>{let{mode,label,icon}=_ref2;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{courseMode:mode,courses:mode==='flex'?[]:data.courses.slice(0,mode==='single'?1:999)})),className:\"p-4 rounded-xl border-2 \".concat(data.courseMode===mode?'border-indigo-600 bg-indigo-50':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl mb-2\",children:icon}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:label})]},mode);})})]}),data.courseMode&&data.courseMode!=='flex'&&/*#__PURE__*/_jsxs(\"div\",{ref:ref,children:[data.courses.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2 mb-3\",children:data.courses.map(c=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:c.code}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{courses:data.courses.filter(x=>x.code!==c.code)})),className:\"hover:bg-indigo-200 rounded-full text-lg leading-none\",children:\"\\xD7\"})]},c.code))}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search courses (e.g., COMP 202)\",value:search,onChange:e=>setSearch(e.target.value),onFocus:()=>setDropdown(true),className:\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"}),dropdown&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 bg-white border-2 rounded-xl max-h-80 overflow-y-auto shadow-xl\",children:filtered.length>0?filtered.map(c=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>toggleCourse(c),className:\"w-full text-left px-4 py-3 hover:bg-gray-50 border-b last:border-0 \".concat(data.courses.find(x=>x.code===c.code)?'bg-indigo-50':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:c.code}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:c.name})]},c.code)):/*#__PURE__*/_jsx(\"div\",{className:\"p-8 text-center text-gray-500\",children:\"No courses found\"})})]}),data.courseMode==='flex'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-indigo-900 font-semibold mb-2\",children:\"\\u2728 Flexible Matching\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-indigo-700\",children:\"You'll be matched with anyone looking to study!\"})]})]}),!showMap&&step===4&&/*#__PURE__*/_jsx(\"div\",{className:\"p-6 space-y-6\",children:data.type==='online'?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDCBB\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold mb-2\",children:\"Online Session\"}),accessToken?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-green-600 font-medium\",children:\"\\u2713 Signed in with Google\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"A Google Meet link will be created when you finish\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-2\",children:\"Connect Google to auto-generate a Meet link\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 mb-4\",children:\"You can also skip this and share a link later\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:signInWithGoogle,className:\"inline-flex items-center gap-2 px-6 py-3 bg-white border-2 border-gray-300 rounded-xl font-medium hover:bg-gray-50 shadow-sm\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 48 48\",children:[/*#__PURE__*/_jsx(\"path\",{fill:\"#EA4335\",d:\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#4285F4\",d:\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#FBBC05\",d:\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#34A853\",d:\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"})]}),\"Sign in with Google\"]})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Where do you want to study?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[{type:'spot',label:'Nearby Spots',icon:'üó∫Ô∏è'},{type:'building',label:'McGill Building',icon:'üèõÔ∏è'}].map(_ref3=>{let{type,label,icon}=_ref3;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{if(type==='spot')openNearbySpots();else setData(_objectSpread(_objectSpread({},data),{},{locType:type}));},className:\"p-4 rounded-xl border-2 \".concat(data.locType===type?'border-indigo-600 bg-indigo-50':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl mb-2\",children:icon}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:label})]},type);})})]}),data.locType==='building'&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:ALL_BUILDINGS.map(b=>{var _data$location2,_data$location3;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{location:b})),className:\"w-full p-4 rounded-xl border-2 text-left \".concat(((_data$location2=data.location)===null||_data$location2===void 0?void 0:_data$location2.id)===b.id?'border-indigo-600 bg-indigo-50':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:b.name}),b.booking&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-indigo-600 mt-1\",children:\"\\u2713 Room booking available\"})]}),((_data$location3=data.location)===null||_data$location3===void 0?void 0:_data$location3.id)===b.id&&b.booking&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-4 bg-yellow-50 border-2 border-yellow-200 rounded-xl\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-yellow-900 font-medium mb-2\",children:\"\\uD83D\\uDCA1 Want to book a room?\"}),/*#__PURE__*/_jsxs(\"a\",{href:b.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"inline-block px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700\",children:[\"Book Room at \",b.name,\" \\u2192\"]})]})]},b.id);})}),data.location&&data.locType==='spot'&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-indigo-50 border-2 border-indigo-200 rounded-xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-indigo-900\",children:[\"\\u2713 Selected: \",data.location.name]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-indigo-700 mt-1\",children:data.location.address}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-indigo-600 mt-1\",children:[\"\\uD83D\\uDCCD \",data.location.distance,\" km away\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:openNearbySpots,className:\"px-3 py-1 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700\",children:\"Change\"})]})})]})}),showMap&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-[600px]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 relative\",children:mapLoaded?/*#__PURE__*/_jsx(\"div\",{ref:mapRef,className:\"w-full h-full\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-5xl mb-4\",children:\"\\uD83D\\uDDFA\\uFE0F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium\",children:\"Map view unavailable\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"Select a spot from the list \\u2192\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-96 bg-white border-l overflow-y-auto\",children:selectedPlace?/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedPlace(null);setShowHoursPanel(false);if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);selectedMarkerRef.current=null;}},className:\"text-indigo-600 hover:underline mb-4 flex items-center gap-1\",children:\"\\u2190 Back to list\"}),((_selectedPlace$photos=selectedPlace.photos)===null||_selectedPlace$photos===void 0?void 0:_selectedPlace$photos[0])&&/*#__PURE__*/_jsx(\"img\",{src:selectedPlace.photos[0].getUrl({maxWidth:400}),alt:selectedPlace.name,className:\"w-full h-48 object-cover rounded-xl mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold mb-2\",children:selectedPlace.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-500\",children:\"\\u2B50\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:selectedPlace.rating}),selectedPlace.totalRatings>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[\"(\",selectedPlace.totalRatings,\" reviews)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCCD\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:selectedPlace.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEB6\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[selectedPlace.distance,\" km away\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCB0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:'$'.repeat(selectedPlace.priceLevel||2)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC65\"}),/*#__PURE__*/_jsx(BusyBadge,{busy:selectedPlace.busy})]}),selectedPlace.openNow!==undefined&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDD50\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium \".concat(selectedPlace.openNow?'text-green-600':'text-red-600'),children:selectedPlace.openNow?'Open now':'Closed'})]})]}),selectedPlace.hours&&selectedPlace.hours.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:!showHoursPanel?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowHoursPanel(true),className:\"text-sm text-indigo-600 hover:text-indigo-800 hover:underline flex items-center gap-1\",children:\"\\uD83D\\uDD50 See opening hours \\u25BE\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-xl p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-sm\",children:\"Opening Hours\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowHoursPanel(false),className:\"text-xs text-gray-500 hover:text-gray-700\",children:\"Hide \\u25B4\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm space-y-1 text-gray-600\",children:selectedPlace.hours.map((h,i)=>{const days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];const today=days[new Date().getDay()];const isToday=h.startsWith(today);return/*#__PURE__*/_jsxs(\"div\",{className:isToday?'font-semibold text-indigo-700':'',children:[h,isToday?' ‚Üê today':'']},i);})})]})}),((_selectedPlace$review=selectedPlace.reviews)===null||_selectedPlace$review===void 0?void 0:_selectedPlace$review.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-3\",children:\"Recent Reviews\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:selectedPlace.reviews.map((r,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-500\",children:\"\\u2B50\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-sm\",children:[r.rating,\"/5\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 line-clamp-3\",children:r.text})]},i))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>selectPlaceFromMap(selectedPlace),className:\"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700\",children:\"Select This Location\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg mb-4\",children:\"Nearby Study Spots\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:mapLoaded?'Click a marker on the map or select from the list':'Select a spot from the list'}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:nearbyPlaces.length>0?nearbyPlaces.map(p=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedPlace(p);setShowHoursPanel(false);placeSelectionPin(p);},className:\"w-full p-4 rounded-xl border-2 border-gray-200 text-left hover:border-indigo-600 hover:bg-indigo-50 transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:p.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:p.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-500\",children:\"\\u2B50\"}),/*#__PURE__*/_jsx(\"span\",{children:p.rating})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600\",children:[\"\\uD83D\\uDCCD \",p.distance,\" km\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-md font-medium \".concat(p.busy==='Quiet'?'bg-green-50 text-green-700':p.busy==='Moderate'?'bg-yellow-50 text-yellow-700':'bg-orange-50 text-orange-700'),children:p.busy})]})]},p.id)):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading nearby places...\"})]})})]})})]}),!showMap&&step===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"When do you want to study?\"}),[{mode:'now',label:'Right Now',sub:'Start immediately',icon:'‚ö°'},{mode:'flexible',label:'Flexible',sub:'Any time this week',icon:'üïê'},{mode:'scheduled',label:'Schedule',sub:'Pick a date & time',icon:'üìÖ'}].map(_ref4=>{let{mode,label,sub,icon}=_ref4;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{timeMode:mode})),className:\"w-full p-5 rounded-xl border-2 text-left \".concat(data.timeMode===mode?'border-indigo-600 bg-indigo-50':'border-gray-200'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl\",children:icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:label}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:sub})]})]})}),mode==='scheduled'&&data.timeMode==='scheduled'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-5 bg-gray-50 rounded-xl space-y-4 border-2 border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-gray-500 mb-1\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:data.date,onChange:e=>setData(_objectSpread(_objectSpread({},data),{},{date:e.target.value})),className:\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\",min:new Date().toISOString().split('T')[0]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-gray-500 mb-1\",children:\"Start time\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:data.start,onChange:e=>setData(_objectSpread(_objectSpread({},data),{},{start:e.target.value})),className:\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-gray-500 mb-1\",children:\"End time\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:data.end,onChange:e=>setData(_objectSpread(_objectSpread({},data),{},{end:e.target.value})),className:\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"})]})]})]})]},mode);})]}),!showMap&&step===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-3\",children:\"Maximum Group Size\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"2\",max:\"50\",value:data.maxMembers,onChange:e=>{const v=parseInt(e.target.value);if(!isNaN(v)&&v>=1&&v<=50)setData(_objectSpread(_objectSpread({},data),{},{maxMembers:v}));else if(e.target.value==='')setData(_objectSpread(_objectSpread({},data),{},{maxMembers:''}));},onBlur:e=>{const v=parseInt(e.target.value);if(isNaN(v)||v<2)setData(_objectSpread(_objectSpread({},data),{},{maxMembers:2}));else if(v>50)setData(_objectSpread(_objectSpread({},data),{},{maxMembers:50}));},placeholder:\"e.g. 5\",className:\"w-32 px-4 py-3 border-2 rounded-xl text-center text-lg font-bold focus:border-indigo-600 outline-none\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500\",children:\"people (2\\u201350)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-3\",children:\"Gender Preference (Optional)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-3\",children:[{val:'any',label:'Any',icon:'üë•'},{val:'male',label:'Male',icon:'üë®'},{val:'female',label:'Female',icon:'üë©'},{val:'non-binary',label:'Non-binary',icon:'üßë'}].map(_ref5=>{let{val,label,icon}=_ref5;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setData(_objectSpread(_objectSpread({},data),{},{genderPref:val})),className:\"p-4 rounded-xl border-2 \".concat(data.genderPref===val?'border-indigo-600 bg-indigo-50':'border-gray-200'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-1\",children:icon}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs font-medium\",children:label})]},val);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border-2 border-indigo-100\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold mb-4\",children:\"\\uD83D\\uDCCB Session Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Type:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium capitalize\",children:(_data$type=data.type)===null||_data$type===void 0?void 0:_data$type.replace('-',' ')})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Visibility:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium capitalize\",children:data.visibility})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Courses:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:data.courseMode==='flex'?'Flexible':data.courses.map(c=>c.code).join(', ')})]}),data.location&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Location:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:data.location.name})]}),data.type==='online'&&!accessToken&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Note:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-amber-600\",children:\"No Google Meet \\u2014 share a link manually\"})]}),data.type==='online'&&accessToken&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Meet:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-green-600\",children:\"Auto-generated Google Meet link\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"When:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium capitalize\",children:data.timeMode})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Max Size:\"}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[data.maxMembers,\" people\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Gender:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium capitalize\",children:data.genderPref})]})]})]})]})]}),!showMap&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-t bg-gray-50 flex justify-between shrink-0\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:step===1?reset:()=>setStep(step-1),className:\"px-5 py-2 text-gray-700 font-medium rounded-lg hover:bg-gray-200\",children:step===1?'Cancel':'‚Üê Back'}),step<6?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setStep(step+1),disabled:!canNext(),className:\"px-6 py-2 rounded-lg font-medium \".concat(canNext()?'bg-indigo-600 text-white hover:bg-indigo-700':'bg-gray-200 text-gray-400'),children:\"Next \\u2192\"}):/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{await handleCreateSession();await createSession();},className:\"w-full px-6 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700\",children:\"Create Session\"})]}),showMap&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-t bg-gray-50 flex justify-between shrink-0\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowMap(false);setSelectedPlace(null);setShowHoursPanel(false);if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);selectedMarkerRef.current=null;}},className:\"px-5 py-2 text-gray-700 font-medium rounded-lg hover:bg-gray-200\",children:\"\\u2190 Back\"}),selectedPlace&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>selectPlaceFromMap(selectedPlace),className:\"px-6 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700\",children:\"Select Location\"})]})]})}),showLocationPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl max-w-sm w-full p-6 text-center shadow-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-5xl mb-4\",children:\"\\uD83D\\uDCCD\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-2\",children:\"Location Access Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mb-2\",children:\"To find nearby study spots, StudyBuddy needs access to your location.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mb-6\",children:\"Please enable location access in your browser settings and try again.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const granted=await requestLocation();if(granted){setShowLocationPopup(false);setShowMap(true);}},className:\"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700\",children:\"Try Again\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLocationPopup(false),className:\"w-full px-4 py-3 text-gray-600 font-medium hover:bg-gray-100 rounded-xl\",children:\"Cancel\"})]})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GOOGLE_CLIENT_ID","SCOPES","GOOGLE_MAPS_API_KEY","ALL_COURSES","ALL_BUILDINGS","id","name","booking","url","FALLBACK_PLACES","address","rating","totalRatings","lat","lng","distance","priceLevel","openNow","busy","hours","StudyBuddy","_selectedPlace$photos","_selectedPlace$review","_data$type","CURRENT_USER_ID","modal","setModal","step","setStep","sessions","setSessions","course","location","time","members","maxMembers","organizer","meetLink","data","setData","type","visibility","courseMode","courses","locType","timeMode","date","start","end","genderPref","search","setSearch","dropdown","setDropdown","userLocation","setUserLocation","nearbyPlaces","setNearbyPlaces","mapLoaded","setMapLoaded","showMap","setShowMap","selectedPlace","setSelectedPlace","showHoursPanel","setShowHoursPanel","ref","mapRef","googleMapRef","markersRef","selectedMarkerRef","googleUser","setGoogleUser","accessToken","setAccessToken","tokenClientRef","placesLoadedRef","locationGranted","setLocationGranted","showLocationPopup","setShowLocationPopup","fetchSessions","_res$data","res","post","user_id","error","console","rawSessions","Array","isArray","mappedSessions","map","s","_s$location","_id","Date","now","when","max_size","created_by","gender","isLive","err","document","createElement","src","async","defer","onload","_window$google","_window$google$accoun","_window$google$accoun2","current","window","google","accounts","oauth2","initTokenClient","client_id","scope","callback","r","access_token","head","appendChild","_window$google2","maps","concat","onerror","signInWithGoogle","requestAccessToken","createGoogleMeetLink","ev","summary","description","dateTime","toISOString","timeZone","Intl","DateTimeFormat","resolvedOptions","conferenceData","createRequest","requestId","Math","random","toString","substring","conferenceSolutionKey","_d$conferenceData","_d$conferenceData$ent","fetch","method","headers","Authorization","body","JSON","stringify","d","json","ep","entryPoints","find","e","entryPointType","uri","_unused","requestLocation","Promise","resolve","navigator","geolocation","getCurrentPosition","p","coords","latitude","longitude","calculateDistance","lat1","lng1","lat2","lng2","R","dLat","PI","dLng","a","sin","cos","atan2","sqrt","toFixed","placeSelectionPin","place","_window$google3","setMap","m","Marker","position","title","animation","Animation","BOUNCE","icon","encodeURIComponent","scaledSize","Size","anchor","Point","setTimeout","setAnimation","panTo","setZoom","loadFallbackPlaces","h","getHours","places","floor","_objectSpread","fetchNearbyPlaces","_window$google4","_window$google4$maps","svc","PlacesService","req","LatLng","radius","keyword","t","nearbySearch","results","status","clearTimeout","PlacesServiceStatus","OK","length","forEach","slice","_place$opening_hours","dist","geometry","pd","place_id","vicinity","user_ratings_total","placeId","price_level","opening_hours","open_now","photos","mk","DROP","addListener","getDetails","fields","det","ds","prev","_det$opening_hours","_det$reviews","weekday_text","website","phone","formatted_phone_number","reviews","push","sort","b","parseFloat","_window$google5","Map","center","zoom","styles","featureType","elementType","stylers","path","SymbolPath","CIRCLE","scale","fillColor","fillOpacity","strokeColor","strokeWeight","contains","target","addEventListener","removeEventListener","filtered","filter","c","code","toLowerCase","includes","toggleCourse","ex","canNext","handleCreateSession","courseName","join","sessionToSave","note","alert","createSession","_data$courses$","_data$location","ns","open","reset","joinSession","openNearbySpots","granted","selectPlaceFromMap","BusyBadge","_ref","className","children","onClick","style","width","replace","v","mode","label","_ref2","x","placeholder","value","onChange","onFocus","height","viewBox","fill","_ref3","_data$location2","_data$location3","href","rel","getUrl","maxWidth","alt","repeat","undefined","i","days","today","getDay","isToday","startsWith","text","sub","_ref4","min","split","max","parseInt","isNaN","onBlur","val","_ref5","disabled"],"sources":["C:/Users/jengs/Desktop/studdyBuddy/studybuddy/src/StudyBuddy.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport axios from \"axios\";\r\n\r\n\r\nconst GOOGLE_CLIENT_ID = '690038744070-3o95qmee1h9mk3aas12st4q36k824m8b.apps.googleusercontent.com';\r\nconst SCOPES = 'https://www.googleapis.com/auth/calendar.events';\r\nconst GOOGLE_MAPS_API_KEY = 'AIzaSyBeS7SWjIBiudPOTdrhluEJwhtriQZWOzg';\r\n\r\nconst ALL_COURSES = [\r\n  {\"code\": \"ACCT 351\", \"name\": \"Intermediate Financial Accounting 1\"},\r\n  {\"code\": \"ACCT 352\", \"name\": \"Intermediate Financial Accounting 2\"},\r\n  {\"code\": \"ACCT 361\", \"name\": \"Managerial Accounting\"},\r\n  {\"code\": \"COMP 202\", \"name\": \"Foundations of Programming\"},\r\n  {\"code\": \"COMP 206\", \"name\": \"Introduction to Software Systems\"},\r\n  {\"code\": \"COMP 250\", \"name\": \"Introduction to Computer Science\"},\r\n  {\"code\": \"COMP 251\", \"name\": \"Algorithms and Data Structures\"},\r\n  {\"code\": \"COMP 273\", \"name\": \"Introduction to Computer Systems\"},\r\n  {\"code\": \"ECON 208\", \"name\": \"Microeconomic Analysis and Applications\"},\r\n  {\"code\": \"ECON 209\", \"name\": \"Macroeconomic Analysis and Applications\"},\r\n  {\"code\": \"MATH 140\", \"name\": \"Calculus 1\"},\r\n  {\"code\": \"MATH 141\", \"name\": \"Calculus 2\"},\r\n  {\"code\": \"PSYC 100\", \"name\": \"Introduction to Psychology 1\"},\r\n  {\"code\": \"BIOL 111\", \"name\": \"Principles: Organismal Biology\"},\r\n  {\"code\": \"CHEM 110\", \"name\": \"General Chemistry 1\"},\r\n];\r\n\r\n// McGill Buildings\r\nconst ALL_BUILDINGS = [\r\n  {id: 'mclennan', name: 'McLennan-Redpath Library', booking: false},\r\n  {id: 'schulich', name: 'Schulich Library of Science', booking: false},\r\n  {id: 'humanities', name: 'Humanities & Social Sciences Library', booking: false},\r\n  {id: 'trottier', name: 'Trottier Building', booking: true, url: 'https://calendar.google.com/calendar/u/0/appointments/AcZssZ21fWlz5fAbV51y6M5Bkc3t5denCAnFJ6wZQls='},\r\n];\r\n\r\n// Fallback nearby caf√©s around McGill ‚Äî sorted closest to farthest\r\nconst FALLBACK_PLACES = [\r\n  {id:'cafe7',name:'Second Cup ‚Äì McGill',address:'3475 Rue McTavish, Montr√©al',rating:4.0,totalRatings:310,lat:45.5052,lng:-73.5770,distance:'0.2',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 6:30 AM ‚Äì 9:00 PM','Tuesday: 6:30 AM ‚Äì 9:00 PM','Wednesday: 6:30 AM ‚Äì 9:00 PM','Thursday: 6:30 AM ‚Äì 9:00 PM','Friday: 6:30 AM ‚Äì 9:00 PM','Saturday: 7:30 AM ‚Äì 8:00 PM','Sunday: 7:30 AM ‚Äì 8:00 PM']},\r\n  {id:'cafe6',name:'Arts Caf√©',address:'201 Ave du Pr√©sident-Kennedy, Montr√©al',rating:4.2,totalRatings:450,lat:45.5077,lng:-73.5712,distance:'0.5',priceLevel:1,openNow:true,busy:'Busy',hours:['Monday: 7:00 AM ‚Äì 10:00 PM','Tuesday: 7:00 AM ‚Äì 10:00 PM','Wednesday: 7:00 AM ‚Äì 10:00 PM','Thursday: 7:00 AM ‚Äì 10:00 PM','Friday: 7:00 AM ‚Äì 10:00 PM','Saturday: 8:00 AM ‚Äì 10:00 PM','Sunday: 8:00 AM ‚Äì 10:00 PM']},\r\n  {id:'cafe5',name:'Pikolo Espresso Bar',address:'3418a Ave du Parc, Montr√©al',rating:4.5,totalRatings:720,lat:45.5112,lng:-73.5748,distance:'0.8',priceLevel:1,openNow:true,busy:'Quiet',hours:['Monday: 7:00 AM ‚Äì 7:00 PM','Tuesday: 7:00 AM ‚Äì 7:00 PM','Wednesday: 7:00 AM ‚Äì 7:00 PM','Thursday: 7:00 AM ‚Äì 7:00 PM','Friday: 7:00 AM ‚Äì 7:00 PM','Saturday: 8:00 AM ‚Äì 7:00 PM','Sunday: 8:00 AM ‚Äì 7:00 PM']},\r\n  {id:'cafe4',name:'Caf√© Myriade',address:'1432 Rue Mackay, Montr√©al',rating:4.5,totalRatings:1560,lat:45.4973,lng:-73.5778,distance:'0.9',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 7:30 AM ‚Äì 6:00 PM','Tuesday: 7:30 AM ‚Äì 6:00 PM','Wednesday: 7:30 AM ‚Äì 6:00 PM','Thursday: 7:30 AM ‚Äì 6:00 PM','Friday: 7:30 AM ‚Äì 6:00 PM','Saturday: 8:30 AM ‚Äì 6:00 PM','Sunday: 8:30 AM ‚Äì 6:00 PM']},\r\n  {id:'cafe8',name:'Caf√© Nocturne',address:'3584 Boul Saint-Laurent, Montr√©al',rating:4.3,totalRatings:560,lat:45.5150,lng:-73.5680,distance:'1.2',priceLevel:2,openNow:true,busy:'Quiet',hours:['Monday: 8:00 AM ‚Äì 11:00 PM','Tuesday: 8:00 AM ‚Äì 11:00 PM','Wednesday: 8:00 AM ‚Äì 11:00 PM','Thursday: 8:00 AM ‚Äì 11:00 PM','Friday: 8:00 AM ‚Äì 11:00 PM','Saturday: 9:00 AM ‚Äì 12:00 AM','Sunday: 9:00 AM ‚Äì 10:00 PM']},\r\n  {id:'cafe2',name:'Crew Collective & Caf√©',address:'360 Rue Saint-Jacques, Montr√©al',rating:4.4,totalRatings:3120,lat:45.5025,lng:-73.5604,distance:'1.6',priceLevel:2,openNow:true,busy:'Busy',hours:['Monday: 8:00 AM ‚Äì 5:00 PM','Tuesday: 8:00 AM ‚Äì 5:00 PM','Wednesday: 8:00 AM ‚Äì 5:00 PM','Thursday: 8:00 AM ‚Äì 5:00 PM','Friday: 8:00 AM ‚Äì 5:00 PM','Saturday: 9:00 AM ‚Äì 5:00 PM','Sunday: 9:00 AM ‚Äì 5:00 PM']},\r\n  {id:'cafe1',name:'Caf√© Olimpico',address:'124 Rue Saint-Viateur O, Montr√©al',rating:4.5,totalRatings:2840,lat:45.5225,lng:-73.5985,distance:'2.4',priceLevel:2,openNow:true,busy:'Moderate',hours:['Monday: 6:00 AM ‚Äì 12:00 AM','Tuesday: 6:00 AM ‚Äì 12:00 AM','Wednesday: 6:00 AM ‚Äì 12:00 AM','Thursday: 6:00 AM ‚Äì 12:00 AM','Friday: 6:00 AM ‚Äì 12:00 AM','Saturday: 6:00 AM ‚Äì 12:00 AM','Sunday: 6:00 AM ‚Äì 12:00 AM']},\r\n  {id:'cafe3',name:'Dispatch Coffee',address:'1000 Rue Bellechasse, Montr√©al',rating:4.6,totalRatings:890,lat:45.5341,lng:-73.5956,distance:'3.5',priceLevel:2,openNow:true,busy:'Quiet',hours:['Monday: 8:00 AM ‚Äì 5:00 PM','Tuesday: 8:00 AM ‚Äì 5:00 PM','Wednesday: 8:00 AM ‚Äì 5:00 PM','Thursday: 8:00 AM ‚Äì 5:00 PM','Friday: 8:00 AM ‚Äì 5:00 PM','Saturday: 9:00 AM ‚Äì 5:00 PM','Sunday: 9:00 AM ‚Äì 5:00 PM']},\r\n];\r\n\r\nexport default function StudyBuddy() {\r\nconst CURRENT_USER_ID = \"user_001\";\r\n// const [sessionType, setSessionType] = useState(\"online\");\r\n// const [visibility, setVisibility] = useState(\"public\");\r\n// const [selectedCourse, setSelectedCourse] = useState(\"\");\r\n// const [note, setNote] = useState(\"\");\r\n// const [whenValue, setWhenValue] = useState(\"now\");\r\n// const [maxSize, setMaxSize] = useState(5);\r\n// const [gender, setGender] = useState(\"any\");\r\n\r\n  const [modal, setModal] = useState(false);\r\n  const [step, setStep] = useState(1);\r\n  const [sessions, setSessions] = useState([\r\n    {id: 1, course: 'COMP 202', name: 'Programming Practice', location: 'Caf√© Olimpico', time: '2:00 PM', members: 2, maxMembers: 5, organizer: 'Sarah Chen', meetLink: null}\r\n  ]);\r\n  const [data, setData] = useState({\r\n    type: '', visibility: '', courseMode: '', courses: [],\r\n    locType: '', location: null, timeMode: '', date: '', start: '', end: '',\r\n    maxMembers: 5, genderPref: 'any'\r\n  });\r\n  const [search, setSearch] = useState('');\r\n  const [dropdown, setDropdown] = useState(false);\r\n  const [userLocation, setUserLocation] = useState(null);\r\n  const [nearbyPlaces, setNearbyPlaces] = useState([]);\r\n  const [mapLoaded, setMapLoaded] = useState(false);\r\n  const [showMap, setShowMap] = useState(false);\r\n  const [selectedPlace, setSelectedPlace] = useState(null);\r\n  const [showHoursPanel, setShowHoursPanel] = useState(false);\r\n  const ref = useRef(null);\r\n  const mapRef = useRef(null);\r\n  const googleMapRef = useRef(null);\r\n  const markersRef = useRef([]);\r\n  const selectedMarkerRef = useRef(null);\r\n  const [googleUser, setGoogleUser] = useState(null);\r\n  const [accessToken, setAccessToken] = useState(null);\r\n  const tokenClientRef = useRef(null);\r\n  const placesLoadedRef = useRef(false);\r\n  const [locationGranted, setLocationGranted] = useState(false);\r\n  const [showLocationPopup, setShowLocationPopup] = useState(false);\r\n\r\n  useEffect(() => {\r\n  const fetchSessions = async () => {\r\n    try {\r\n      const res = await axios.post(\"http://127.0.0.1:8000/sessions/match\", {\r\n        user_id: CURRENT_USER_ID,\r\n      });\r\n\r\n      if (res.data?.error) {\r\n        console.error(\"Error fetching matched sessions:\", res.data.error);\r\n        setSessions([]);\r\n        return;\r\n      }\r\n\r\n      const rawSessions = Array.isArray(res.data) ? res.data : [];\r\n      const mappedSessions = rawSessions.map(s => ({\r\n      id: s._id || Date.now(),\r\n      course: s.course || \"Study\",\r\n      name: s.course || \"Study Session\", // fallback to course if no name\r\n      location: s.type === \"online\" ? \"Online\" : (s.location?.name || s.location || \"TBD\"),\r\n      time: s.when === \"now\" ? \"LIVE NOW\" : s.when || \"TBD\",\r\n      members: s.members || 1,\r\n      maxMembers: s.max_size || 5,\r\n      organizer: s.created_by || \"Unknown\",\r\n      meetLink: s.meetLink || null,\r\n      genderPref: s.gender || \"any\",\r\n      isLive: s.when === \"now\"\r\n    }));\r\n\r\n\r\n      setSessions(mappedSessions);\r\n\r\n    } catch (err) {\r\n      console.error(\"Error fetching sessions:\", err);\r\n    }\r\n  };\r\n\r\n  fetchSessions();\r\n}, []);\r\n\r\n\r\n  // Load Google Identity Services\r\n  useEffect(() => {\r\n    const s = document.createElement('script');\r\n    s.src = 'https://accounts.google.com/gsi/client'; s.async = true; s.defer = true;\r\n    s.onload = () => {\r\n      tokenClientRef.current = window.google?.accounts?.oauth2?.initTokenClient({\r\n        client_id: GOOGLE_CLIENT_ID, scope: SCOPES,\r\n        callback: (r) => { if (r.access_token) { setAccessToken(r.access_token); setGoogleUser(true); } },\r\n      });\r\n    };\r\n    document.head.appendChild(s);\r\n  }, []);\r\n\r\n  // Load Google Maps\r\n  useEffect(() => {\r\n    if (!window.google?.maps) {\r\n      const s = document.createElement('script');\r\n      s.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places`;\r\n      s.async = true;\r\n      s.onload = () => setMapLoaded(true);\r\n      s.onerror = () => setMapLoaded(false);\r\n      document.head.appendChild(s);\r\n    } else { setMapLoaded(true); }\r\n  }, []);\r\n\r\n  const signInWithGoogle = () => { if (tokenClientRef.current) tokenClientRef.current.requestAccessToken(); };\r\n\r\n  const createGoogleMeetLink = async () => {\r\n    if (!accessToken) return null;\r\n    const ev = {\r\n      summary: 'StudyBuddy Session', description: 'Study session created via StudyBuddy',\r\n      start: { dateTime: new Date().toISOString(), timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone },\r\n      end: { dateTime: new Date(Date.now() + 7200000).toISOString(), timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone },\r\n      conferenceData: { createRequest: { requestId: Math.random().toString(36).substring(2,12), conferenceSolutionKey: { type: 'hangoutsMeet' } } },\r\n    };\r\n    try {\r\n      const res = await fetch('https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1',\r\n        { method: 'POST', headers: { Authorization: `Bearer ${accessToken}`, 'Content-Type': 'application/json' }, body: JSON.stringify(ev) });\r\n      const d = await res.json();\r\n      const ep = d.conferenceData?.entryPoints?.find(e => e.entryPointType === 'video');\r\n      return ep ? ep.uri : null;\r\n    } catch { return null; }\r\n  };\r\n\r\n  // Geolocation ‚Äî only set location if user grants permission\r\n  const requestLocation = useCallback(() => {\r\n    return new Promise((resolve) => {\r\n      if (!navigator.geolocation) { resolve(false); return; }\r\n      navigator.geolocation.getCurrentPosition(\r\n        p => { setUserLocation({ lat: p.coords.latitude, lng: p.coords.longitude }); setLocationGranted(true); resolve(true); },\r\n        () => { setLocationGranted(false); resolve(false); }\r\n      );\r\n    });\r\n  }, []);\r\n\r\n  // Try requesting on mount silently\r\n  useEffect(() => { requestLocation(); }, [requestLocation]);\r\n\r\n  const calculateDistance = useCallback((lat1, lng1, lat2, lng2) => {\r\n    const R = 6371, dLat = (lat2-lat1)*Math.PI/180, dLng = (lng2-lng1)*Math.PI/180;\r\n    const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLng/2)**2;\r\n    return (R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))).toFixed(1);\r\n  }, []);\r\n\r\n  const placeSelectionPin = useCallback((place) => {\r\n    if (!googleMapRef.current || !window.google?.maps) return;\r\n    if (selectedMarkerRef.current) { selectedMarkerRef.current.setMap(null); }\r\n    const m = new window.google.maps.Marker({\r\n      position: { lat: place.lat, lng: place.lng }, map: googleMapRef.current, title: place.name,\r\n      animation: window.google.maps.Animation.BOUNCE,\r\n      icon: {\r\n        url: `data:image/svg+xml,${encodeURIComponent('<svg width=\"44\" height=\"54\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M22 0C12.3 0 4.4 7.9 4.4 17.6c0 9.7 17.6 36.4 17.6 36.4s17.6-26.7 17.6-36.4C39.6 7.9 31.7 0 22 0z\" fill=\"#DC2626\"/><circle cx=\"22\" cy=\"17.6\" r=\"8.8\" fill=\"white\"/><text x=\"22\" y=\"22\" text-anchor=\"middle\" font-size=\"14\" fill=\"#DC2626\">‚òÖ</text></svg>')}`,\r\n        scaledSize: new window.google.maps.Size(44, 54), anchor: new window.google.maps.Point(22, 54)\r\n      }\r\n    });\r\n    selectedMarkerRef.current = m;\r\n    setTimeout(() => m?.setAnimation(null), 1400);\r\n    googleMapRef.current.panTo({ lat: place.lat, lng: place.lng });\r\n    googleMapRef.current.setZoom(16);\r\n  }, []);\r\n\r\n  const loadFallbackPlaces = useCallback(() => {\r\n    const h = new Date().getHours();\r\n    const places = FALLBACK_PLACES.map(p => {\r\n      let busy = 'Moderate';\r\n      if (h >= 8 && h <= 11) busy = ['Busy','Moderate','Quiet'][Math.floor(Math.random()*3)];\r\n      else if (h >= 12 && h <= 14) busy = 'Busy';\r\n      else if (h >= 15 && h <= 17) busy = ['Busy','Moderate'][Math.floor(Math.random()*2)];\r\n      else busy = 'Quiet';\r\n      return { ...p, busy };\r\n    });\r\n    setNearbyPlaces(places);\r\n    placesLoadedRef.current = true;\r\n  }, []);\r\n\r\n  const fetchNearbyPlaces = useCallback((map) => {\r\n    if (!window.google?.maps?.places || !userLocation) { loadFallbackPlaces(); return; }\r\n    const svc = new window.google.maps.places.PlacesService(map);\r\n    const req = { location: new window.google.maps.LatLng(userLocation.lat, userLocation.lng), radius: 2000, type: ['cafe'], keyword: 'coffee study wifi' };\r\n    const t = setTimeout(() => { if (!placesLoadedRef.current) loadFallbackPlaces(); }, 5000);\r\n    svc.nearbySearch(req, (results, status) => {\r\n      clearTimeout(t);\r\n      if (status === window.google.maps.places.PlacesServiceStatus.OK && results?.length > 0) {\r\n        markersRef.current.forEach(m => m.setMap(null)); markersRef.current = [];\r\n        const places = results.slice(0, 15).map(place => {\r\n          const dist = calculateDistance(userLocation.lat, userLocation.lng, place.geometry.location.lat(), place.geometry.location.lng());\r\n          const h = new Date().getHours();\r\n          let busy = 'Moderate';\r\n          if (h>=8&&h<=11) busy=['Busy','Moderate','Quiet'][Math.floor(Math.random()*3)];\r\n          else if (h>=12&&h<=14) busy='Busy';\r\n          else if (h>=15&&h<=17) busy=['Busy','Moderate'][Math.floor(Math.random()*2)];\r\n          else busy='Quiet';\r\n          const pd = { id: place.place_id, name: place.name, address: place.vicinity, rating: place.rating||4.0, totalRatings: place.user_ratings_total||0, busy, lat: place.geometry.location.lat(), lng: place.geometry.location.lng(), placeId: place.place_id, distance: dist, priceLevel: place.price_level||2, openNow: place.opening_hours?.open_now, photos: place.photos };\r\n          const mk = new window.google.maps.Marker({\r\n            position: { lat: pd.lat, lng: pd.lng }, map, title: pd.name, animation: window.google.maps.Animation.DROP,\r\n            icon: { url: `data:image/svg+xml,${encodeURIComponent('<svg width=\"40\" height=\"50\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20 0C11.2 0 4 7.2 4 16c0 8.8 16 34 16 34s16-25.2 16-34c0-8.8-7.2-16-16-16z\" fill=\"#6366F1\"/><circle cx=\"20\" cy=\"16\" r=\"8\" fill=\"white\"/><text x=\"20\" y=\"21\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366F1\" font-weight=\"bold\">‚òï</text></svg>')}`, scaledSize: new window.google.maps.Size(40, 50), anchor: new window.google.maps.Point(20, 50) }\r\n          });\r\n          mk.addListener('click', () => {\r\n            setSelectedPlace(pd); setShowHoursPanel(false); placeSelectionPin(pd);\r\n            svc.getDetails({ placeId: pd.placeId, fields: ['opening_hours','website','formatted_phone_number','reviews'] }, (det, ds) => {\r\n              if (ds === window.google.maps.places.PlacesServiceStatus.OK) {\r\n                setSelectedPlace(prev => ({ ...prev, hours: det.opening_hours?.weekday_text, website: det.website, phone: det.formatted_phone_number, reviews: det.reviews?.slice(0,3) }));\r\n              }\r\n            });\r\n          });\r\n          markersRef.current.push(mk);\r\n          return pd;\r\n        });\r\n        setNearbyPlaces(places.sort((a,b) => parseFloat(a.distance) - parseFloat(b.distance))); placesLoadedRef.current = true;\r\n      } else { loadFallbackPlaces(); }\r\n    });\r\n  }, [userLocation, loadFallbackPlaces, placeSelectionPin, calculateDistance]);\r\n\r\n  // Map init\r\n  useEffect(() => {\r\n    if (showMap && userLocation) {\r\n      // Load fallback places immediately so list is never empty\r\n      if (!placesLoadedRef.current) loadFallbackPlaces();\r\n      if (mapLoaded && window.google?.maps && mapRef.current) {\r\n        const map = new window.google.maps.Map(mapRef.current, {\r\n          center: userLocation, zoom: 14,\r\n          styles: [{ featureType: \"poi\", elementType: \"labels\", stylers: [{ visibility: \"off\" }] }]\r\n        });\r\n        googleMapRef.current = map;\r\n        new window.google.maps.Marker({ position: userLocation, map, title: \"You\",\r\n          icon: { path: window.google.maps.SymbolPath.CIRCLE, scale: 10, fillColor: \"#4F46E5\", fillOpacity: 1, strokeColor: \"#fff\", strokeWeight: 2 }\r\n        });\r\n        fetchNearbyPlaces(map);\r\n      }\r\n    }\r\n  }, [showMap, mapLoaded, userLocation, fetchNearbyPlaces, loadFallbackPlaces]);\r\n\r\n  useEffect(() => {\r\n    const h = e => { if (ref.current && !ref.current.contains(e.target)) setDropdown(false); };\r\n    document.addEventListener('mousedown', h); return () => document.removeEventListener('mousedown', h);\r\n  }, []);\r\n\r\n  const filtered = ALL_COURSES.filter(c => c.code.toLowerCase().includes(search.toLowerCase()) || c.name.toLowerCase().includes(search.toLowerCase()));\r\n\r\n  const toggleCourse = (course) => {\r\n    if (data.courseMode === 'single') { setData({...data, courses: [course]}); setDropdown(false); }\r\n    else { const ex = data.courses.find(c => c.code === course.code); setData({...data, courses: ex ? data.courses.filter(c => c.code !== course.code) : [...data.courses, course]}); }\r\n  };\r\n\r\n  // canNext: online sessions always pass step 4 (Google sign-in optional)\r\n  const canNext = () => {\r\n    if (step === 1) return data.type;\r\n    if (step === 2) return data.visibility;\r\n    if (step === 3) return data.courseMode === 'flex' || data.courses.length > 0;\r\n    if (step === 4) return data.type === 'online' || data.location;\r\n    if (step === 5) {\r\n      if (!data.timeMode) return false;\r\n      if (data.timeMode === 'scheduled') return data.date && data.start && data.end;\r\n      return true;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleCreateSession = async () => {\r\n  const courseName = data.courseMode === 'flex'\r\n    ? 'Flexible'\r\n    : data.courses.length > 0\r\n      ? data.courses.map(c => c.code).join(', ')\r\n      : 'Study';\r\n\r\n  const sessionToSave = {\r\n    type: data.type,\r\n    visibility: data.visibility,\r\n    course: courseName,\r\n    note: data.note || '',\r\n    when: data.timeMode === 'now'\r\n      ? 'now'\r\n      : data.timeMode === 'scheduled'\r\n        ? `${data.date} ${data.start} - ${data.end}`\r\n        : 'flexible',\r\n    max_size: data.maxMembers,\r\n    gender: data.genderPref,\r\n    created_by: \"Maria\"\r\n  };\r\n\r\n  try {\r\n    await axios.post(\"http://127.0.0.1:8000/sessions\", sessionToSave);\r\n    alert(\"Session created successfully!\");\r\n  } catch (error) {\r\n    console.error(\"Error creating session:\", error);\r\n  }\r\n};\r\n\r\n\r\n  const createSession = async () => {\r\n    \r\n    let meetLink = null;\r\n    if (data.type === 'online' && accessToken) meetLink = await createGoogleMeetLink();\r\n    const ns = {\r\n      id: Date.now(),\r\n      course: data.courseMode === 'flex' ? 'Flexible' : data.courses[0]?.code || 'Study',\r\n      name: data.courseMode === 'flex' ? 'General Study Session' : data.courses.map(c => c.code).join(', '),\r\n      location: data.type === 'online' ? 'Online' : data.location?.name,\r\n      time: data.timeMode === 'now' ? 'LIVE NOW' : data.timeMode === 'scheduled' ? `${data.date} ${data.start}` : 'Flexible',\r\n      members: 1, maxMembers: data.maxMembers, organizer: 'You', meetLink, genderPref: data.genderPref, isLive: data.timeMode === 'now'\r\n    };\r\n    setSessions([ns, ...sessions]);\r\n    if (meetLink) window.open(meetLink, '_blank');\r\n    reset();\r\n  };\r\n\r\n  const reset = () => {\r\n    setModal(false); setStep(1);\r\n    setData({ type:'', visibility:'', courseMode:'', courses:[], locType:'', location:null, timeMode:'', date:'', start:'', end:'', maxMembers:5, genderPref:'any' });\r\n    setSearch(''); setShowMap(false); setSelectedPlace(null); setShowHoursPanel(false);\r\n    placesLoadedRef.current = false;\r\n    if (selectedMarkerRef.current) { selectedMarkerRef.current.setMap(null); selectedMarkerRef.current = null; }\r\n  };\r\n\r\n  const joinSession = s => { if (s.meetLink) window.open(s.meetLink, '_blank'); else alert(`Joining ${s.name} at ${s.location}!`); };\r\n\r\n  const openNearbySpots = async () => {\r\n    setData(d => ({...d, locType: 'spot'}));\r\n    if (locationGranted && userLocation) {\r\n      setShowMap(true);\r\n    } else {\r\n      const granted = await requestLocation();\r\n      if (granted) { setShowMap(true); }\r\n      else { setShowLocationPopup(true); }\r\n    }\r\n  };\r\n\r\n  const selectPlaceFromMap = place => {\r\n    setData({...data, location: place}); setShowMap(false); setSelectedPlace(null); setShowHoursPanel(false);\r\n    if (selectedMarkerRef.current) { selectedMarkerRef.current.setMap(null); selectedMarkerRef.current = null; }\r\n  };\r\n\r\n  const BusyBadge = ({busy}) => (\r\n    <span className={`px-2 py-1 rounded-full text-xs font-medium ${busy==='Quiet'?'bg-green-100 text-green-700':busy==='Moderate'?'bg-yellow-100 text-yellow-700':'bg-orange-100 text-orange-700'}`}>{busy}</span>\r\n  );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm p-4 border-b flex justify-between items-center\">\r\n        <h1 className=\"text-2xl font-bold text-indigo-600\">StudyBuddy</h1>\r\n        {googleUser ? <span className=\"text-sm text-green-600 font-medium\">‚úì Google Connected</span> :\r\n          <button onClick={signInWithGoogle} className=\"text-sm px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700\">Sign in with Google</button>}\r\n      </div>\r\n\r\n      {/* Sessions */}\r\n      <div className=\"max-w-6xl mx-auto p-6\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Active Sessions</h2>\r\n        <div className=\"grid md:grid-cols-2 gap-4\">\r\n          {sessions.map(s => (\r\n            <div key={s.id} className=\"bg-white p-6 rounded-xl shadow-md border-2 border-gray-100\">\r\n              <div className=\"flex justify-between items-start mb-2\">\r\n                <div><span className=\"text-sm font-semibold text-indigo-600\">{s.course}</span><h3 className=\"font-bold text-lg mt-1\">{s.name}</h3></div>\r\n                {s.isLive && <span className=\"px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full\">LIVE</span>}\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">üìç {s.location}</p>\r\n              <p className=\"text-sm text-gray-600\">üïê {s.time}</p>\r\n              <p className=\"text-sm text-gray-600\">üë• {s.members}/{s.maxMembers} members</p>\r\n              {s.genderPref !== 'any' && <p className=\"text-sm text-gray-600\">‚öß {s.genderPref} preferred</p>}\r\n              <div className=\"mt-4 pt-4 border-t flex justify-between items-center\">\r\n                <span className=\"text-sm text-gray-500\">by {s.organizer}</span>\r\n                <button onClick={() => joinSession(s)} className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700\">{s.meetLink ? 'Join Meet' : 'Join'}</button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* FAB */}\r\n      <button onClick={() => setModal(true)} className=\"fixed bottom-8 right-8 w-16 h-16 bg-indigo-600 text-white rounded-full shadow-2xl hover:scale-110 transition-transform flex items-center justify-center text-3xl z-50\">+</button>\r\n\r\n      {/* Modal */}\r\n      {modal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto\">\r\n          <div className=\"bg-white rounded-2xl w-full max-w-6xl max-h-[95vh] flex flex-col my-4\">\r\n            {/* Modal Header */}\r\n            <div className=\"p-6 border-b flex justify-between items-center shrink-0\">\r\n              <div>\r\n                <h2 className=\"text-xl font-bold\">{showMap ? 'Choose Study Spot' : ['Session Type','Who Can Join?','Course Selection','Study Location','When to Study?','Group Details'][step-1]}</h2>\r\n                {!showMap && <p className=\"text-sm text-gray-500\">Step {step} of 6</p>}\r\n              </div>\r\n              <button onClick={reset} className=\"text-gray-400 hover:text-gray-600 text-2xl\">√ó</button>\r\n            </div>\r\n\r\n            {/* Progress */}\r\n            {!showMap && <div className=\"px-6 py-3 bg-gray-50 shrink-0\"><div className=\"bg-gray-200 rounded-full h-2\"><div className=\"bg-indigo-600 h-2 rounded-full transition-all\" style={{width:`${(step/6)*100}%`}}/></div></div>}\r\n\r\n            {/* Content */}\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n              {/* Step 1 */}\r\n              {!showMap && step === 1 && (\r\n                <div className=\"p-6 space-y-4\">\r\n                  <p className=\"text-gray-600 mb-6\">How would you like to study?</p>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    {['online','in-person'].map(t => (\r\n                      <button key={t} onClick={() => setData({...data, type: t})} className={`p-6 rounded-xl border-2 transition-all ${data.type===t?'border-indigo-600 bg-indigo-50 scale-105':'border-gray-200'}`}>\r\n                        <div className=\"text-4xl mb-3\">{t==='online'?'üíª':'üìç'}</div>\r\n                        <div className=\"font-bold capitalize\">{t.replace('-',' ')}</div>\r\n                        <div className=\"text-sm text-gray-500 mt-1\">{t==='online'?'Google Meet':'Meet at location'}</div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 2 */}\r\n              {!showMap && step === 2 && (\r\n                <div className=\"p-6 space-y-4\">\r\n                  <p className=\"text-gray-600 mb-6\">Who can see and join?</p>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    {['public','private'].map(v => (\r\n                      <button key={v} onClick={() => setData({...data, visibility: v})} className={`p-6 rounded-xl border-2 transition-all ${data.visibility===v?'border-indigo-600 bg-indigo-50 scale-105':'border-gray-200'}`}>\r\n                        <div className=\"text-4xl mb-3\">{v==='public'?'üåç':'üîí'}</div>\r\n                        <div className=\"font-bold capitalize\">{v}</div>\r\n                        <div className=\"text-sm text-gray-500 mt-1\">{v==='public'?'Everyone':'Friends only'}</div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 3 */}\r\n              {!showMap && step === 3 && (\r\n                <div className=\"p-6 space-y-6\">\r\n                  <div>\r\n                    <p className=\"text-gray-600 mb-4\">What are you studying?</p>\r\n                    <div className=\"grid grid-cols-3 gap-3\">\r\n                      {[{mode:'single',label:'One Course',icon:'üìñ'},{mode:'multi',label:'Multiple',icon:'üìö'},{mode:'flex',label:'Flexible',icon:'‚ú®'}].map(({mode,label,icon}) => (\r\n                        <button key={mode} onClick={() => setData({...data, courseMode: mode, courses: mode==='flex'?[]:data.courses.slice(0,mode==='single'?1:999)})} className={`p-4 rounded-xl border-2 ${data.courseMode===mode?'border-indigo-600 bg-indigo-50':'border-gray-200'}`}>\r\n                          <div className=\"text-3xl mb-2\">{icon}</div><div className=\"text-sm font-medium\">{label}</div>\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  {data.courseMode && data.courseMode !== 'flex' && (\r\n                    <div ref={ref}>\r\n                      {data.courses.length > 0 && <div className=\"flex flex-wrap gap-2 mb-3\">{data.courses.map(c => (\r\n                        <div key={c.code} className=\"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full flex items-center gap-2\">\r\n                          <span className=\"text-sm font-medium\">{c.code}</span>\r\n                          <button onClick={() => setData({...data, courses: data.courses.filter(x => x.code !== c.code)})} className=\"hover:bg-indigo-200 rounded-full text-lg leading-none\">√ó</button>\r\n                        </div>\r\n                      ))}</div>}\r\n                      <input type=\"text\" placeholder=\"Search courses (e.g., COMP 202)\" value={search} onChange={e => setSearch(e.target.value)} onFocus={() => setDropdown(true)} className=\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"/>\r\n                      {dropdown && <div className=\"mt-2 bg-white border-2 rounded-xl max-h-80 overflow-y-auto shadow-xl\">\r\n                        {filtered.length > 0 ? filtered.map(c => (\r\n                          <button key={c.code} onClick={() => toggleCourse(c)} className={`w-full text-left px-4 py-3 hover:bg-gray-50 border-b last:border-0 ${data.courses.find(x=>x.code===c.code)?'bg-indigo-50':''}`}>\r\n                            <div className=\"font-semibold\">{c.code}</div><div className=\"text-sm text-gray-600\">{c.name}</div>\r\n                          </button>\r\n                        )) : <div className=\"p-8 text-center text-gray-500\">No courses found</div>}\r\n                      </div>}\r\n                    </div>\r\n                  )}\r\n                  {data.courseMode === 'flex' && <div className=\"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-6\"><p className=\"text-indigo-900 font-semibold mb-2\">‚ú® Flexible Matching</p><p className=\"text-sm text-indigo-700\">You'll be matched with anyone looking to study!</p></div>}\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 4 */}\r\n              {!showMap && step === 4 && (\r\n                <div className=\"p-6 space-y-6\">\r\n                  {data.type === 'online' ? (\r\n                    <div className=\"text-center py-12\">\r\n                      <div className=\"text-6xl mb-4\">üíª</div>\r\n                      <h3 className=\"text-xl font-bold mb-2\">Online Session</h3>\r\n                      {accessToken ? (\r\n                        <div><p className=\"text-green-600 font-medium\">‚úì Signed in with Google</p><p className=\"text-gray-600 mt-2\">A Google Meet link will be created when you finish</p></div>\r\n                      ) : (\r\n                        <div>\r\n                          <p className=\"text-gray-600 mb-2\">Connect Google to auto-generate a Meet link</p>\r\n                          <p className=\"text-sm text-gray-400 mb-4\">You can also skip this and share a link later</p>\r\n                          <button onClick={signInWithGoogle} className=\"inline-flex items-center gap-2 px-6 py-3 bg-white border-2 border-gray-300 rounded-xl font-medium hover:bg-gray-50 shadow-sm\">\r\n                            <svg width=\"20\" height=\"20\" viewBox=\"0 0 48 48\"><path fill=\"#EA4335\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"/><path fill=\"#4285F4\" d=\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"/><path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"/><path fill=\"#34A853\" d=\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"/></svg>\r\n                            Sign in with Google\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      <div>\r\n                        <p className=\"text-gray-600 mb-4\">Where do you want to study?</p>\r\n                        <div className=\"grid grid-cols-2 gap-3\">\r\n                          {[{type:'spot',label:'Nearby Spots',icon:'üó∫Ô∏è'},{type:'building',label:'McGill Building',icon:'üèõÔ∏è'}].map(({type,label,icon}) => (\r\n                            <button key={type} onClick={() => { if (type==='spot') openNearbySpots(); else setData({...data, locType: type}); }}\r\n                              className={`p-4 rounded-xl border-2 ${data.locType===type?'border-indigo-600 bg-indigo-50':'border-gray-200'}`}>\r\n                              <div className=\"text-3xl mb-2\">{icon}</div><div className=\"text-sm font-medium\">{label}</div>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                      {data.locType === 'building' && (\r\n                        <div className=\"space-y-3\">\r\n                          {ALL_BUILDINGS.map(b => (\r\n                            <div key={b.id}>\r\n                              <button onClick={() => setData({...data, location: b})} className={`w-full p-4 rounded-xl border-2 text-left ${data.location?.id===b.id?'border-indigo-600 bg-indigo-50':'border-gray-200'}`}>\r\n                                <div className=\"font-semibold\">{b.name}</div>\r\n                                {b.booking && <div className=\"text-sm text-indigo-600 mt-1\">‚úì Room booking available</div>}\r\n                              </button>\r\n                              {data.location?.id === b.id && b.booking && (\r\n                                <div className=\"mt-2 p-4 bg-yellow-50 border-2 border-yellow-200 rounded-xl\">\r\n                                  <p className=\"text-sm text-yellow-900 font-medium mb-2\">üí° Want to book a room?</p>\r\n                                  <a href={b.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"inline-block px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700\">Book Room at {b.name} ‚Üí</a>\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                      {data.location && data.locType === 'spot' && (\r\n                        <div className=\"p-4 bg-indigo-50 border-2 border-indigo-200 rounded-xl\">\r\n                          <div className=\"flex justify-between items-start\">\r\n                            <div>\r\n                              <p className=\"font-semibold text-indigo-900\">‚úì Selected: {data.location.name}</p>\r\n                              <p className=\"text-sm text-indigo-700 mt-1\">{data.location.address}</p>\r\n                              <p className=\"text-sm text-indigo-600 mt-1\">üìç {data.location.distance} km away</p>\r\n                            </div>\r\n                            <button onClick={openNearbySpots} className=\"px-3 py-1 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700\">Change</button>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Map View */}\r\n              {showMap && (\r\n                <div className=\"flex h-[600px]\">\r\n                  <div className=\"flex-1 relative\">\r\n                    {mapLoaded ? <div ref={mapRef} className=\"w-full h-full\" /> : (\r\n                      <div className=\"w-full h-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center\">\r\n                        <div className=\"text-center\"><div className=\"text-5xl mb-4\">üó∫Ô∏è</div><p className=\"text-gray-600 font-medium\">Map view unavailable</p><p className=\"text-sm text-gray-500 mt-1\">Select a spot from the list ‚Üí</p></div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"w-96 bg-white border-l overflow-y-auto\">\r\n                    {selectedPlace ? (\r\n                      <div className=\"p-6\">\r\n                        <button onClick={() => { setSelectedPlace(null); setShowHoursPanel(false); if (selectedMarkerRef.current) { selectedMarkerRef.current.setMap(null); selectedMarkerRef.current=null; } }}\r\n                          className=\"text-indigo-600 hover:underline mb-4 flex items-center gap-1\">‚Üê Back to list</button>\r\n                        {selectedPlace.photos?.[0] && <img src={selectedPlace.photos[0].getUrl({maxWidth:400})} alt={selectedPlace.name} className=\"w-full h-48 object-cover rounded-xl mb-4\"/>}\r\n                        <h3 className=\"text-xl font-bold mb-2\">{selectedPlace.name}</h3>\r\n                        <div className=\"space-y-3 mb-4\">\r\n                          <div className=\"flex items-center gap-2\"><span className=\"text-yellow-500\">‚≠ê</span><span className=\"font-medium\">{selectedPlace.rating}</span>{selectedPlace.totalRatings>0&&<span className=\"text-sm text-gray-500\">({selectedPlace.totalRatings} reviews)</span>}</div>\r\n                          <div className=\"flex items-center gap-2\"><span>üìç</span><span className=\"text-sm\">{selectedPlace.address}</span></div>\r\n                          <div className=\"flex items-center gap-2\"><span>üö∂</span><span className=\"text-sm\">{selectedPlace.distance} km away</span></div>\r\n                          <div className=\"flex items-center gap-2\"><span>üí∞</span><span className=\"text-sm\">{'$'.repeat(selectedPlace.priceLevel||2)}</span></div>\r\n                          <div className=\"flex items-center gap-2\"><span>üë•</span><BusyBadge busy={selectedPlace.busy}/></div>\r\n                          {selectedPlace.openNow !== undefined && <div className=\"flex items-center gap-2\"><span>üïê</span><span className={`text-sm font-medium ${selectedPlace.openNow?'text-green-600':'text-red-600'}`}>{selectedPlace.openNow?'Open now':'Closed'}</span></div>}\r\n                        </div>\r\n\r\n                        {/* Opening hours toggle */}\r\n                        {selectedPlace.hours && selectedPlace.hours.length > 0 && (\r\n                          <div className=\"mb-4\">\r\n                            {!showHoursPanel ? (\r\n                              <button onClick={() => setShowHoursPanel(true)} className=\"text-sm text-indigo-600 hover:text-indigo-800 hover:underline flex items-center gap-1\">\r\n                                üïê See opening hours ‚ñæ\r\n                              </button>\r\n                            ) : (\r\n                              <div className=\"bg-gray-50 rounded-xl p-4\">\r\n                                <div className=\"flex justify-between items-center mb-2\">\r\n                                  <h4 className=\"font-semibold text-sm\">Opening Hours</h4>\r\n                                  <button onClick={() => setShowHoursPanel(false)} className=\"text-xs text-gray-500 hover:text-gray-700\">Hide ‚ñ¥</button>\r\n                                </div>\r\n                                <div className=\"text-sm space-y-1 text-gray-600\">\r\n                                  {selectedPlace.hours.map((h, i) => {\r\n                                    const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];\r\n                                    const today = days[new Date().getDay()];\r\n                                    const isToday = h.startsWith(today);\r\n                                    return <div key={i} className={isToday?'font-semibold text-indigo-700':''}>{h}{isToday?' ‚Üê today':''}</div>;\r\n                                  })}\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n\r\n                        {selectedPlace.reviews?.length > 0 && (\r\n                          <div className=\"mb-6\">\r\n                            <h4 className=\"font-semibold mb-3\">Recent Reviews</h4>\r\n                            <div className=\"space-y-3\">{selectedPlace.reviews.map((r, i) => (\r\n                              <div key={i} className=\"bg-gray-50 p-3 rounded-lg\">\r\n                                <div className=\"flex items-center gap-2 mb-1\"><span className=\"text-yellow-500\">‚≠ê</span><span className=\"font-medium text-sm\">{r.rating}/5</span></div>\r\n                                <p className=\"text-sm text-gray-600 line-clamp-3\">{r.text}</p>\r\n                              </div>\r\n                            ))}</div>\r\n                          </div>\r\n                        )}\r\n                        <button onClick={() => selectPlaceFromMap(selectedPlace)} className=\"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700\">Select This Location</button>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"p-4\">\r\n                        <h3 className=\"font-bold text-lg mb-4\">Nearby Study Spots</h3>\r\n                        <p className=\"text-sm text-gray-500 mb-4\">{mapLoaded?'Click a marker on the map or select from the list':'Select a spot from the list'}</p>\r\n                        <div className=\"space-y-3\">\r\n                          {nearbyPlaces.length > 0 ? nearbyPlaces.map(p => (\r\n                            <button key={p.id} onClick={() => { setSelectedPlace(p); setShowHoursPanel(false); placeSelectionPin(p); }}\r\n                              className=\"w-full p-4 rounded-xl border-2 border-gray-200 text-left hover:border-indigo-600 hover:bg-indigo-50 transition-all\">\r\n                              <div className=\"flex justify-between items-start mb-2\">\r\n                                <div className=\"flex-1\"><div className=\"font-semibold\">{p.name}</div><div className=\"text-xs text-gray-500 mt-1\">{p.address}</div></div>\r\n                                <div className=\"text-sm flex items-center gap-1\"><span className=\"text-yellow-500\">‚≠ê</span><span>{p.rating}</span></div>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-3 text-xs\">\r\n                                <span className=\"text-gray-600\">üìç {p.distance} km</span>\r\n                                <span className={`px-2 py-1 rounded-md font-medium ${p.busy==='Quiet'?'bg-green-50 text-green-700':p.busy==='Moderate'?'bg-yellow-50 text-yellow-700':'bg-orange-50 text-orange-700'}`}>{p.busy}</span>\r\n                              </div>\r\n                            </button>\r\n                          )) : (\r\n                            <div className=\"text-center py-8 text-gray-500\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-3\"></div><p>Loading nearby places...</p></div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 5 */}\r\n              {!showMap && step === 5 && (\r\n                <div className=\"p-6 space-y-3\">\r\n                  <p className=\"text-gray-600 mb-4\">When do you want to study?</p>\r\n                  {[{mode:'now',label:'Right Now',sub:'Start immediately',icon:'‚ö°'},{mode:'flexible',label:'Flexible',sub:'Any time this week',icon:'üïê'},{mode:'scheduled',label:'Schedule',sub:'Pick a date & time',icon:'üìÖ'}].map(({mode,label,sub,icon}) => (\r\n                    <div key={mode}>\r\n                      <button onClick={() => setData({...data, timeMode: mode})} className={`w-full p-5 rounded-xl border-2 text-left ${data.timeMode===mode?'border-indigo-600 bg-indigo-50':'border-gray-200'}`}>\r\n                        <div className=\"flex items-center gap-3\"><div className=\"text-3xl\">{icon}</div><div><div className=\"font-bold\">{label}</div><div className=\"text-sm text-gray-500\">{sub}</div></div></div>\r\n                      </button>\r\n                      {mode === 'scheduled' && data.timeMode === 'scheduled' && (\r\n                        <div className=\"mt-2 p-5 bg-gray-50 rounded-xl space-y-4 border-2 border-gray-100\">\r\n                          <div>\r\n                            <label className=\"block text-xs font-semibold text-gray-500 mb-1\">Date</label>\r\n                            <input type=\"date\" value={data.date} onChange={e => setData({...data, date: e.target.value})} className=\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\" min={new Date().toISOString().split('T')[0]}/>\r\n                          </div>\r\n                          <div className=\"grid grid-cols-2 gap-3\">\r\n                            <div>\r\n                              <label className=\"block text-xs font-semibold text-gray-500 mb-1\">Start time</label>\r\n                              <input type=\"time\" value={data.start} onChange={e => setData({...data, start: e.target.value})} className=\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"/>\r\n                            </div>\r\n                            <div>\r\n                              <label className=\"block text-xs font-semibold text-gray-500 mb-1\">End time</label>\r\n                              <input type=\"time\" value={data.end} onChange={e => setData({...data, end: e.target.value})} className=\"w-full px-4 py-3 border-2 rounded-xl focus:border-indigo-600 outline-none\"/>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 6 */}\r\n              {!showMap && step === 6 && (\r\n                <div className=\"p-6 space-y-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-3\">Maximum Group Size</label>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"2\"\r\n                        max=\"50\"\r\n                        value={data.maxMembers}\r\n                        onChange={e => {\r\n                          const v = parseInt(e.target.value);\r\n                          if (!isNaN(v) && v >= 1 && v <= 50) setData({...data, maxMembers: v});\r\n                          else if (e.target.value === '') setData({...data, maxMembers: ''});\r\n                        }}\r\n                        onBlur={e => {\r\n                          const v = parseInt(e.target.value);\r\n                          if (isNaN(v) || v < 2) setData({...data, maxMembers: 2});\r\n                          else if (v > 50) setData({...data, maxMembers: 50});\r\n                        }}\r\n                        placeholder=\"e.g. 5\"\r\n                        className=\"w-32 px-4 py-3 border-2 rounded-xl text-center text-lg font-bold focus:border-indigo-600 outline-none\"\r\n                      />\r\n                      <span className=\"text-sm text-gray-500\">people (2‚Äì50)</span>\r\n                    </div>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold text-gray-700 mb-3\">Gender Preference (Optional)</label>\r\n                    <div className=\"grid grid-cols-4 gap-3\">\r\n                      {[{val:'any',label:'Any',icon:'üë•'},{val:'male',label:'Male',icon:'üë®'},{val:'female',label:'Female',icon:'üë©'},{val:'non-binary',label:'Non-binary',icon:'üßë'}].map(({val,label,icon}) => (\r\n                        <button key={val} onClick={() => setData({...data, genderPref: val})} className={`p-4 rounded-xl border-2 ${data.genderPref===val?'border-indigo-600 bg-indigo-50':'border-gray-200'}`}>\r\n                          <div className=\"text-2xl mb-1\">{icon}</div><div className=\"text-xs font-medium\">{label}</div>\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border-2 border-indigo-100\">\r\n                    <h4 className=\"font-bold mb-4\">üìã Session Summary</h4>\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div><span className=\"text-gray-600\">Type:</span> <span className=\"font-medium capitalize\">{data.type?.replace('-',' ')}</span></div>\r\n                      <div><span className=\"text-gray-600\">Visibility:</span> <span className=\"font-medium capitalize\">{data.visibility}</span></div>\r\n                      <div><span className=\"text-gray-600\">Courses:</span> <span className=\"font-medium\">{data.courseMode==='flex'?'Flexible':data.courses.map(c=>c.code).join(', ')}</span></div>\r\n                      {data.location && <div><span className=\"text-gray-600\">Location:</span> <span className=\"font-medium\">{data.location.name}</span></div>}\r\n                      {data.type==='online' && !accessToken && <div><span className=\"text-gray-600\">Note:</span> <span className=\"font-medium text-amber-600\">No Google Meet ‚Äî share a link manually</span></div>}\r\n                      {data.type==='online' && accessToken && <div><span className=\"text-gray-600\">Meet:</span> <span className=\"font-medium text-green-600\">Auto-generated Google Meet link</span></div>}\r\n                      <div><span className=\"text-gray-600\">When:</span> <span className=\"font-medium capitalize\">{data.timeMode}</span></div>\r\n                      <div><span className=\"text-gray-600\">Max Size:</span> <span className=\"font-medium\">{data.maxMembers} people</span></div>\r\n                      <div><span className=\"text-gray-600\">Gender:</span> <span className=\"font-medium capitalize\">{data.genderPref}</span></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Footer */}\r\n            {!showMap && (\r\n              <div className=\"p-6 border-t bg-gray-50 flex justify-between shrink-0\">\r\n                <button onClick={step===1?reset:()=>setStep(step-1)} className=\"px-5 py-2 text-gray-700 font-medium rounded-lg hover:bg-gray-200\">{step===1?'Cancel':'‚Üê Back'}</button>\r\n                {step < 6 ? (\r\n                  <button onClick={() => setStep(step+1)} disabled={!canNext()} className={`px-6 py-2 rounded-lg font-medium ${canNext()?'bg-indigo-600 text-white hover:bg-indigo-700':'bg-gray-200 text-gray-400'}`}>Next ‚Üí</button>\r\n                ) : (\r\n                  <button onClick={async () => {\r\n                    await handleCreateSession();   \r\n                    await createSession();         \r\n                    }}\r\n  className=\"w-full px-6 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700\"\r\n>\r\n  Create Session\r\n</button>\r\n\r\n                  \r\n                )}\r\n              </div>\r\n            )}\r\n            {showMap && (\r\n              <div className=\"p-6 border-t bg-gray-50 flex justify-between shrink-0\">\r\n                <button onClick={() => { \r\n                  setShowMap(false); setSelectedPlace(null); setShowHoursPanel(false); if(selectedMarkerRef.current){selectedMarkerRef.current.setMap(null);selectedMarkerRef.current=null;} }} className=\"px-5 py-2 text-gray-700 font-medium rounded-lg hover:bg-gray-200\">‚Üê Back</button>\r\n                {selectedPlace && <button onClick={() => selectPlaceFromMap(selectedPlace)} className=\"px-6 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700\">Select Location</button>}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Location permission popup */}\r\n      {showLocationPopup && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]\">\r\n          <div className=\"bg-white rounded-2xl max-w-sm w-full p-6 text-center shadow-2xl\">\r\n            <div className=\"text-5xl mb-4\">üìç</div>\r\n            <h3 className=\"text-lg font-bold mb-2\">Location Access Required</h3>\r\n            <p className=\"text-gray-600 text-sm mb-2\">\r\n              To find nearby study spots, StudyBuddy needs access to your location.\r\n            </p>\r\n            <p className=\"text-gray-500 text-xs mb-6\">\r\n              Please enable location access in your browser settings and try again.\r\n            </p>\r\n            <div className=\"space-y-2\">\r\n              <button\r\n                onClick={async () => {\r\n                  const granted = await requestLocation();\r\n                  if (granted) { setShowLocationPopup(false); setShowMap(true); }\r\n                }}\r\n                className=\"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700\"\r\n              >\r\n                Try Again\r\n              </button>\r\n              <button\r\n                onClick={() => setShowLocationPopup(false)}\r\n                className=\"w-full px-4 py-3 text-gray-600 font-medium hover:bg-gray-100 rounded-xl\"\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}